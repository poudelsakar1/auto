const _ = require('lodash')

const list = [
  'VOLVO:S60:T5 MOMENTUM',
  'VOLVO:S60:T6 MOMENTUM',
  'VOLVO:S60:T6 R-DESIGN',
  'VOLVO:S60:T6 INSCRIPTION',
  'VOLVO:S90:T6 R-DESIGN',
  'VOLVO:XC40:T5 MOMENTUM',
  'VOLVO:XC40:T5 INSCRIPTION',
  'VOLVO:XC40:T5 R-DESIGN',
  'VOLVO:XC60:T5 MOMENTUM',
  'VOLVO:XC60:T5 INSCRIPTION',
  'VOLVO:XC60:T6 MOMENTUM',
  'VOLVO:XC60:T6 INSCRIPTION',
  'VOLVO:XC90:T5 MOMENTUM 7 PASSENGER',
  'VOLVO:XC90:T6 MOMENTUM 6 PASSENGER',
  'VOLVO:XC90:T6 MOMENTUM 7 PASSENGER',
  'VOLVO:XC90:T6 INSCRIPTION 6 PASSENGER',
  'VOLVO:XC90:T6 INSCRIPTION 7 PASSENGER',
  'VOLVO:V60:T5 CROSS COUNTRY AWD',
  'SUBARU:IMPREZA HATCHBACK:2.0I AUTO',
  'SUBARU:IMPREZA HATCHBACK:LIMITED AUTO',
  'SUBARU:IMPREZA SEDAN:2.0I PREMIUM AUTO',
  'SUBARU:IMPREZA HATCHBACK:2.0I PREMIUM AUTO',
  'SUBARU:IMPREZA SEDAN:SPORT AUTO',
  'SUBARU:IMPREZA HATCHBACK:SPORT AUTO',
  'SUBARU:CROSSTREK:5D WAGON AUTO',
  'SUBARU:CROSSTREK :5D WAGON LIMITED AUTO',
  'SUBARU:CROSSTREK :5D WAGON PREMIUM AUTO',
  'SUBARU:CROSSTREK:5D WAGON SPORT AUTO',
  'SUBARU:FORESTER :4D WAGON 2.5I',
  'SUBARU:FORESTER :4D WAGON 2.5I LIMITED',
  'SUBARU:FORESTER :4D WAGON 2.5I PREMIUM',
  'SUBARU:FORESTER :4D WAGON 2.5I SPORT',
  'SUBARU:FORESTER:4D WAGON 2.5I TOURING',
  'SUBARU:OUTBACK:5D WAGON 2.5L AWD',
  'SUBARU:OUTBACK :5D WAGON 2.5L LIMITED AWD',
  'SUBARU:OUTBACK :5D WAGON 2.4T LIMITED XT AWD',
  'SUBARU:OUTBACK :5D WAGON 2.4T ONYX EDITION XT AWD',
  'SUBARU:OUTBACK:5D WAGON 2.5L PREMIUM AWD',
  'SUBARU:OUTBACK :5D WAGON 2.5L TOURING AWD',
  'SUBARU:OUTBACK:5D WAGON 2.4T TOURING XT AWD',
  'SUBARU:ASCENT:4D WAGON LIMITED 7-PASSENGER',
  'SUBARU:ASCENT:4D WAGON LIMITED 8 PASSENGER',
  'SUBARU:ASCENT:4D WAGON PREMIUM 7-PASSENGER',
  'SUBARU:ASCENT:4D WAGON PREMIUM',
  'SUBARU:ASCENT:4D WAGON TOURING 7-PASSENGER',
  'SUBARU:LEGACY :4D SEDAN 2.5L AWD',
  'SUBARU:LEGACY :4D SEDAN 2.5L LIMITED AWD',
  'SUBARU:LEGACY :4D SEDAN 2.4T LIMITED XT AWD',
  'SUBARU:LEGACY :4D SEDAN 2.5L PREMIUM AWD',
  'SUBARU:LEGACY :4D SEDAN 2.5L SPORT AWD',
  'SUBARU:LEGACY:4D SEDAN 2.4T TOURING XT AWD',
  'MAZDA:CX-3:SPORT AWD',
  'MAZDA:CX-30:BASE AWD',
  'MAZDA:CX-30:SELECT AWD',
  'MAZDA:CX-30:PREFERRED AWD',
  'MAZDA:CX-30:PREMIUM AWD',
  'MAZDA:CX-5:SPORT AWD',
  'MAZDA:CX-5:TOURING AWD',
  'MAZDA:CX-5:TOURING AWD WITH PREFERRED SV PACKAGE',
  'MAZDA:CX-5:CARBON EDITION AWD',
  'MAZDA:CX-5:CARBON EDITION TURBO AWD',
  'MAZDA:CX-5:GRAND TOURING AWD',
  'MAZDA:CX-5:GRAND TOURING AWD WITH PREMIUM PACKAGE',
  'MAZDA:CX-5:GRAND TOURING RESERVE AWD',
  'MAZDA:CX-5:SIGNATURE AWD',
  'MAZDA:CX-9:SPORT AWD',
  'MAZDA:CX-9:TOURING AWD',
  'MAZDA:CX-9:TOURING AWD WITH PREMIUM PACKAGE (6 PASSENGER)',
  'MAZDA:CX-9:TOURING AWD WITH PREMIUM PACKAGE (7 PASSENGER)',
  'MAZDA:CX-9:CARBON EDITION AWD',
  'MAZDA:CX-9:GRAND TOURING AWD',
  'MAZDA:CX-9:SIGNATURE AWD',
  'MAZDA:MAZDA3 SEDAN:SELECT AWD',
  'MAZDA:MAZDA3 SEDAN:SELECT FWD',
  'MAZDA:MAZDA3 SEDAN:PREFERRED AWD',
  'MAZDA:MAZDA3 SEDAN:PREFERRED FWD',
  'MAZDA:MAZDA3 SEDAN:PREMIUM AWD',
  'MAZDA:MAZDA3 SEDAN:PREMIUM FWD',
  'MAZDA:MAZDA3 SEDAN:2.5 TURBO AWD',
  'MAZDA:MAZDA3 HATCHBACK:SELECT AWD',
  'MAZDA:MAZDA3 HATCHBACK:PREFERRED AWD',
  'MAZDA:MAZDA3 HATCHBACK:PREMIUM AWD',
  'MAZDA:MAZDA6:SPORT FWD',
  'MAZDA:MAZDA6:TOURING FWD',
  'MAZDA:MAZDA6:GRAND TOURING FWD',
  'MAZDA:MAZDA6:GRAND TOURING RESERVE FWD',
  'MAZDA:MAZDA6:SIGNATURE FWD',
  'AUDI:A4 :4D SEDAN 40 PREMIUM',
  'AUDI:A4 :4D SEDAN 40 PREMIUM PLUS',
  'AUDI:A4 :4D SEDAN 45 PREMIUM PLUS',
  'AUDI:A5:5D SPORTBACK 40 PREMIUM PLUS',
  'AUDI:A5:5D SPORTBACK 40 PRESTIGE',
  'AUDI:A5:2D CABRIOLET 45 PREMIUM ',
  'AUDI:A5:5D SPORTBACK 45 PREMIUM PLUS',
  'AUDI:A5:2D CABRIOLET 45 PREMIUM PLUS',
  'AUDI:A5:5D SPORTBACK 45 PRESTIGE',
  'AUDI:A6:4D SEDAN 45 PREMIUM',
  'AUDI:A6:4D SEDAN 45 PREMIUM PLUS',
  'AUDI:E-TRON:5D WAGON PREMIUM',
  'AUDI:E-TRON:5D WAGON PREMIUM PLUS',
  'AUDI:Q3:4D WAGON S-LINE PREMIUM',
  'AUDI:Q3:4D WAGON S-LINE PREMIUM PLUS',
  'AUDI:Q5:4D WAGON 45 PREMIUM',
  'AUDI:Q5:4D WAGON 45 PREMIUM PLUS',
  'AUDI:Q5:4D WAGON 45 PRESTIGE',
  'AUDI:Q5:4D WAGON 55 E PREMIUM',
  'AUDI:Q5:4D WAGON 55 E PREMIUM PLUS',
  'AUDI:Q5:4D WAGON 55 E PRESTIGE',
  'AUDI:Q7:4D WAGON 45 PREMIUM',
  'AUDI:Q7:4D WAGON 45 PREMIUM PLUS',
  'AUDI:Q7:4D WAGON 55 PREMIUM',
  'AUDI:Q7:4D WAGON 55 PREMIUM PLUS',
  'AUDI:Q7:4D WAGON 55 PRESTIGE',
  'AUDI:S4:4D SEDAN PREMIUM',
  'AUDI:S4:4D SEDAN PREMIUM PLUS',
  'AUDI:S5:5D SPORTBACK PREMIUM PLUS',
  'AUDI:S5:5D SPORTBACK PRESTIGE',
  'AUDI:S5:2D CONVERTIBLE PREMIUM PLUS',
  'AUDI:S5:2D CONVERTIBLE PRESTIGE',
  'AUDI:SQ5:4D WAGON PREMIUM PLUS',
  'AUDI:SQ5:4D WAGON PRESTIGE',
  'AUDI:SQ7:4D WAGON PREMIUM PLUS',
  'AUDI:SQ7:4D WAGON PRESTIGE',
  'AUDI:SQ8:4D WAGON PREMIUM PLUS',
  'AUDI:SQ8:4D WAGON PRESTIGE',
  'ACURA:ILX:4D SEDAN',
  'ACURA:ILX :4D SEDAN PREMIUM',
  'ACURA:ILX:4D SEDAN PREMIUM A-SPEC',
  'ACURA:ILX:4D SEDAN TECHNOLOGY A-SPEC',
  'ACURA:MDX :4D WAGON SH-AWD',
  'ACURA:MDX :4D WAGON SH-AWD ADVANCE',
  'ACURA:MDX :4D WAGON SH-AWD W/TECH',
  'ACURA:MDX:4D WAGON SH-AWD W/TECH/ENT./A-SPEC',
  'ACURA:RDX:4D SUV SH AWD ',
  'ACURA:RDX :4D SUV SH AWD W/TECHNOLOGY',
  'ACURA:RDX :4D SUV SH AWD W/A-SPEC',
  'ACURA:RDX:4D SUV SH AWD W/ADVANCE',
  'ACURA:TLX:4D SEDAN',
  'ACURA:TLX BASE SH-AWD:4D SEDAN SH-AWD',
  'ACURA:TLX TECHNOLOGY:4D SEDAN W/TECH',
  'ACURA:TLX TECHNOLOGY SH-AWD:4D SEDAN W/TECH SH-AWD',
  'ACURA:TLX A-SPEC:4D SEDAN W/A-SPEC ',
  'ACURA:TLX A-SPEC SH-AWD:4D SEDAN W//A-SPEC SH-AWD',
  'ACURA:TLX 3.5L ADVANCE PKG:4D SEDAN W/ADVANCE ',
  'ACURA:TLX 3.5L ADVANCE PKG SH-AWD:4D SEDAN W/ADVANCE SH-AWD ',
  'INFINITI:Q50:4D SEDAN 3.0T PURE AWD',
  'INFINITI:Q50 :4D SEDAN 3.0T LUXE AWD',
  'INFINITI:Q50:4D SEDAN 3.0T SENSORY AWD',
  'INFINITI:Q50:4D SEDAN 3.0T RED SPORT AWD',
  'INFINITI:QX50 :4D WAGON PURE AWD',
  'INFINITI:QX50 :4D WAGON LUXE AWD',
  'INFINITI:QX50 :4D WAGON ESSENTIAL AWD',
  'INFINITI:QX50:4D WAGON SENSORY AWD',
  'INFINITI:QX60 PURE AWD:4D WAGON PURE AWD',
  'INFINITI:QX60 LUXE AWD:4D WAGON LUXE AWD',
  'INFINITI:QX80:4D WAGON LUXE 4WD',
  'INFINITI:QX80:4D WAGON PREMIUM SELECT 4WD',
  'INFINITI:QX80:4D WAGON SENSORY 4WD',
  'NISSAN:ALTIMA 2.5 S AWD:',
  'NISSAN:ALTIMA 2.5 S FWD:',
  'NISSAN:ALTIMA 2.5 SL AWD:',
  'NISSAN:ALTIMA 2.5 SL FWD:',
  'NISSAN:ALTIMA 2.5 SR AWD:',
  'NISSAN:ALTIMA 2.5 SR FWD:',
  'NISSAN:ALTIMA 2.5 SV AWD:',
  'NISSAN:ALTIMA 2.5 SV FWD:',
  'NISSAN:MURANO S:',
  'NISSAN:MURANO SL:',
  'NISSAN:MURANO SV:',
  'NISSAN:MURANO PLATINUM:',
  'NISSAN:ROGUE S:',
  'NISSAN:ROGUE SL:',
  'NISSAN:ROGUE SV:',
  'NISSAN:ROGUE SPORT S:',
  'NISSAN:ROGUE SPORT SL:',
  'NISSAN:ROGUE SPORT SV:',
  'NISSAN:PATHFINDER S:',
  'NISSAN:PATHFINDER SL:',
  'NISSAN:PATHFINDER SV:',
  'NISSAN:PATHFINDER PLATINUM:',
  'NISSAN:SENTRA S:',
  'NISSAN:SENTRA SR:',
  'NISSAN:SENTRA SV:',
  'LEXUS:ES 250 AWD:',
  'LEXUS:ES 250 LUXURY AWD:',
  'LEXUS:ES 300H LUXURY:',
  'LEXUS:ES 350:',
  'LEXUS:GX:',
  'LEXUS:GX 460 PREMIUM:',
  'LEXUS:GX 460:',
  'LEXUS:NX:',
  'LEXUS:NX 300:',
  'LEXUS:NX 300 AWD:',
  'LEXUS:NX 300 F SPORT AWD:',
  'LEXUS:NX 300H F SPORT AWD BLACK LINE SPECIAL EDITION:',
  'LEXUS:RX 350L:',
  'LEXUS:RX 450HL:',
  'LEXUS:RX 350 AWD:',
  'LEXUS:RX 350 F SPORT AWD:',
  'LEXUS:RX 450H AWD:',
  'BMW:2 SERIES:228XI COUPE',
  'BMW:2 SERIES:228XI CONVERTIBLE',
  'BMW:2 SERIES:M240XI COUPE',
  'BMW:2 SERIES:M240XI CONVERTIBLE',
  'BMW:2 SERIES:228XI GRAN COUPE',
  'BMW:2 SERIES:M235XI GRAN COUPE',
  'BMW:3 SERIES:330I XDRIVE',
  'BMW:3 SERIES:330I XDRIVE',
  'BMW:3 SERIES:330I XDRIVE',
  'BMW:3 SERIES:330I XDRIVE',
  'BMW:3 SERIES:M340I XDRIVE',
  'BMW:4 SERIES:430I XDRIVE',
  'BMW:4 SERIES:430I XDRIVE',
  'BMW:4 SERIES:M440I XDRIVE',
  'BMW:5 SERIES:530I XDRIVE',
  'BMW:5 SERIES:540I XDRIVE',
  'BMW:5 SERIES:540I XDRIVE',
  'BMW:5 SERIES:M550I XDRIVE',
  'BMW:7 SERIES:740I XDRIVE',
  'BMW:7 SERIES:745E XDRIVE',
  'BMW:7 SERIES:750I XDRIVE',
  'BMW:7 SERIES:M760I XDRIVE',
  'BMW:8 SERIES:840I XDRIVE COUPE',
  'BMW:8 SERIES:840I XDRIVE CONVERTIBLE',
  'BMW:8 SERIES:840I XDRIVE GRAN COUPE',
  'BMW:8 SERIES:M850I XDRIVE COUPE',
  'BMW:8 SERIES:M850I XDRIVE COUPE',
  'BMW:8 SERIES:M850I XDRIVE GRAN COUPE',
  'BMW:X1:XDRIVE 28I',
  'BMW:X2:XDRIVE 28I',
  'BMW:X2:XDRIVE 35I',
  'BMW:X3:XDRIVE 30I',
  'BMW:X3:XDRIVE 30I',
  'BMW:X3:XDRIVE M40I',
  'BMW:X3:XDRIVE M40I',
  'BMW:X3:XDRIVE 30E',
  'BMW:X4:XDRIVE 30I',
  'BMW:X4:XDRIVE M40I',
  'BMW:X5:XDRIVE 40I',
  'BMW:X5:XDRIVE 40I',
  'BMW:X5:XDRIVE M50I',
  'BMW:X5:XDRIVE 40E',
  'BMW:X6:XDRIVE 40I',
  'BMW:X6:XDRIVE M50I',
  'BMW:X7:XDRIVE 40I',
  'BMW:X7:XDRIVE M50I',
  'BMW:M2:COMPETITION COUPE',
  'BMW:M3:BASE SEDAN',
  'BMW:M4:COMPETITION SEDAN',
  'BMW:M5:BASE SEDAN',
  'BMW:M5:COMPETITION SEDAN',
  'BMW:M8:BASE COUPE',
  'BMW:M8:COMPETITION COUPE',
  'BMW:M8:BASE CONVERTIBLE',
  'BMW:M8:COMPETITION CONVERTIBLE',
  'BMW:M8:BASE GRAN COUPE',
  'BMW:M8:COMPETITION GRAN COUPE',
  'BMW:X3M:BASE',
  'BMW:X3M:COMPETITION',
  'BMW:X4M:BASE',
  'BMW:X4M:COMPETITION',
  'BMW:X5M:BASE',
  'BMW:X5M:COMPETITION',
  'BMW:X6M:BASE',
  'BMW:X6M:COMPETITION',
  'BMW:Z4:30I',
  'BMW:Z4:M40I',
]

const rawList = _.map(list, item => {
  const ds = item.split(':')
  return {
    branch: ds[0],
    rawModels: [`${ds[1]}:${ds[2]}`],
  }
})

const getListMapped = data =>
  _.map(data, item => {
    const ds = item.split(':')
    return {
      model: ds[0].trim(),
      trims: [ds[1].trim()],
    }
  })

const resultRaw = _(rawList)
  .groupBy('branch')
  .map(g =>
    _.mergeWith({}, ...g, (obj, src) =>
      _.isArray(obj) ? obj.concat(src) : undefined,
    ),
  )
  .sortBy('branch')
  .value()

const finalResult = _.map(resultRaw, item => ({
  ...item,
  model: _(getListMapped(item.rawModels))
    .groupBy('model')
    .map(g =>
      _.mergeWith({}, ...g, (obj, src) =>
        _.isArray(obj) ? obj.concat(src) : undefined,
      ),
    )
    .sortBy('model')
    .value(),
}))
